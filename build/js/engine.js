!function(){function e(){C="",S="",L="",b="",A="",$("#residentialPropertyType").find("option:first").prop("selected",!0).end().material_select(),$("#commercialPropertyType").find("option:first").prop("selected",!0).end().material_select(),$("#propertyCat").find("option:first").prop("selected",!0).end().material_select(),$("#minprice,#maxprice,#propertySearchContainer").val("")}function t(){if(!w){w=!0,$(".agentListView .progress").show();var e={city:d,town:h,offset:f};""!==u&&(e.search=u),$.ajax({url:"/api/agentlist.php",method:"get",data:e,success:function(e){if(0!==e.length){if(e[0].agentlist.length<=0&&0!==f)return void $(".agentListView .progress").hide();$(".agentSearchCount").text(e[0].agentcount+" Agents");var t=$("#agentListTmpl").html(),o="";Mustache.parse(t),o=Mustache.render(t,{data:e[0].agentlist,firstCharacter:function(){return this.bname[0]}}),0===f?$(".agentSearchResult ul.collection").empty().html(o):$(".agentSearchResult ul.collection").append(o),$(".agentSearchResult ul.collection li:even").addClass("alternate")}},complete:function(){w=!1,p(),$(".agentListView .progress").hide(),$(window).off("scroll").on("scroll",function(){var e=$(window).scrollTop();return $(window).scrollTop()==$(document).height()-$(window).height()?(f=$(".collection-item").length,t(),void $(window).scrollTop(e)):void 0})}})}}function o(e){var t=[];if(!w){w=!0,$(".appliedFilter").empty(),$(".propertyListView ul.collection").removeClass("filteredResults"),$(".propertyListView .progress").show();var i={city:d,town:h,sellrent:e?e:g,offset:f};e||$(".triggerRent").hasClass("active")&&(i.sellrent="rent"),""!==u&&(i.search=u),""!==C&&(i.rescom=C,t.push(C)),""!==S&&(i.type=S,t.push(S)),""!==L&&(i.sort=L),""!==b&&(i.costmin=b,t.push("min price:"+b)),""!==A&&(i.costmax=A,t.push("max price:"+A)),t.length>0&&($(".appliedFilter").text("You are looking for: "+t.join(", ")).append("<a href='#' class='resetAppliedFilter'> - Clear Filter</a>"),$(".appliedFilter").show(),$(".propertyListView ul.collection").addClass("filteredResults")),$.ajax({url:"/api/propertylist.php",method:"get",data:i,success:function(t){var o=$("#propertyListTmpl").html();if(0===t.length){var i=Mustache.render(o,{data:[]});return void(0===f?$(".propertySearchResult ul.collection,.agentProperties ul.collection").empty().html(i):$(".propertySearchResult ul.collection,.agentProperties ul.collection").find("li").length<=0&&$(".propertySearchResult ul.collection,.agentProperties ul.collection").append(i))}var n=t[0].propertycount?t[0].propertycount:0;if($(".propertySearchCount").text(n+" properties"),1===$("#residentialPropertyType").find("option").length){var r=$("#residentialpropertytypes").html(),i=Mustache.render(r,{data:T});$("#residentialPropertyType").append(i).material_select()}if(1===$("#commercialPropertyType").find("option").length){var a=$("#commercialpropertytypes").html(),i=Mustache.render(a,{data:v});$("#commercialPropertyType").append(i).material_select()}$("#propertyCat").material_select(),$("#sortingType").material_select();var i=Mustache.render(o,{data:t[0].propertylist,propertyMessage:function(){var e=encodeURIComponent("Available for sale at "+this.Cost+": "+this.Type+" | "+this.Locality+" | "+this.Area+" | "+this.Floor+", "+this.Address+", "+this.Rescom+" | "+this.Brokerage+". Contact "+this.agentinfo.bname+":"+this.agentinfo.phoneno+". Sent via miraroadagents.com");return e}});if(e||$(".triggerRent").hasClass("active")){o=$("#propertyRentListTmpl").html();var i=Mustache.render(o,{data:t[0].propertylist,propertyMessage:function(){var e=encodeURIComponent("Available for rent of "+this.Rent+" / "+this.Deposite+": "+this.Type+" | "+this.Locality+" | "+this.Area+" | "+this.Floor+", "+this.Address+", "+this.Rescom+" | "+this.Brokerage+". Contact "+this.agentinfo.bname+":"+this.agentinfo.phoneno+". Sent via miraroadagents.com");return e}})}0===f?$(".propertySearchResult ul.collection,.agentProperties ul.collection").empty().html(i):$(".propertySearchResult ul.collection,.agentProperties ul.collection").append(i),$(".propertySearchResult ul.collection li:even,.agentProperties ul.collection li:even").addClass("alternate")},complete:function(){w=!1,p(),$(".propertyListView .progress").hide(),e?$(window).off("scroll").on("scroll",function(){$(window).scrollTop()==$(document).height()-$(window).height()&&(f=$(".collection-item").length,o("rent"))}):$(window).off("scroll").on("scroll",function(){$(window).scrollTop()==$(document).height()-$(window).height()&&(f=$(".collection-item").length,o())})}})}}function i(){$(".showAgentList,.showPropertyList").hide(),$(".agentListView").is(":visible")?(t(),$(".showPropertyList").show()):$(".propertyListView").is(":visible")?(o(),$(".showAgentList").show()):$(".showAgentList,.showPropertyList").show()}function n(e){for(var t=window.location.search.substring(1),o=t.split("&"),i=0;i<o.length;i++){var n=o[i].split("=");if(n[0]==e)return n[1]}return!1}function r(e,t){$(window).off("scroll"),$(".module:not(.agentInfo)").hide(),$(".agentInfo").fadeIn("fast");var o=$("#agentInfoTmpl").html();if(t)var o=$("#agentRentInfoTmpl").html();Mustache.parse(o);var i=Mustache.render(o,{data:e[0],firstCharacter:function(){return this.bname[0]},message:function(){var e=encodeURIComponent("See properties with "+this.bname+" at http://omestateconsultancy.com/anirudh_prabhu/index.html?uid="+this.uid);return e},propertyMessage:function(){var e=encodeURIComponent("Available for sale for "+this.Cost+": "+this.Type+" | "+this.Locality+" | "+this.Area+" | "+this.Floor+", "+this.Address+", "+this.Rescom+" | "+this.Brokerage+". Contact "+this.agentInfo.bname+": "+this.agentInfo.phoneno+". Sent via miraroadagents.com");return e},rentMessage:function(){var e=encodeURIComponent("Available for rent of "+this.Rent+" / "+this.Deposite+": "+this.Type+" | "+this.Locality+" | "+this.Area+" | "+this.Floor+", "+this.Address+", "+this.Rescom+" | "+this.Brokerage+". Contact: "+this.agentInfo.bname+":"+this.agentInfo.phoneno+". Sent via miraroadagents.com");return e}});$(".agentInfo").empty().html(i),$(".agentInfo").find("li:even").addClass("alternate"),m||($(".button-collapse").sideNav({menuWidth:300,edge:"left",closeOnClick:!0}),m=!0),window.location.hash="agentinfo"}function a(){$("#agentSearchContainer").off("keyup"),$("#agentSearchContainer").typing({stop:function(e,o){u=o.val(),t()},delay:400})}function s(){$("#propertySearchContainer").off("keyup"),$("#propertySearchContainer").typing({stop:function(e,t){u=t.val(),o()},delay:400})}function l(){$("#minprice").off("keyup"),$("#minprice").typing({stop:function(e,t){return b=t.val(),isNaN(b)?(Materialize.toast("Please enter a number for minimum price.",4e3),!1):void o()},delay:400})}function c(){$("#maxprice").off("keyup"),$("#maxprice").typing({stop:function(e,t){return A=t.val(),isNaN(A)?(Materialize.toast("Please enter a number for maximum price.",4e3),!1):void o()},delay:400})}function p(){""!==d&&($("select.selectCity").val(d).material_select(),$("select.selectTown").val(h))}var d="",h="",g="SELL",u="",f=0,m=!1,w=!1,y=0,v=[],T=[],C="",S="",L="",b="",A="";if($(document).on("click",".changeFilter",function(e){e.preventDefault(),$(".filterArea").slideToggle(),$(this).toggleClass("filterOpen")}),$(document).on("click",".closeFilterDialog",function(e){e.preventDefault(),$(".triggerFilter").trigger("click"),o()}),$(document).on("click",".triggerFilter",function(e){e.preventDefault(),$(".filterSection").slideToggle(),$(this).toggleClass("triggerFilterOpen"),$(".sortSection").is(":visible")&&($(".sortSection").slideToggle(),$(this).toggleClass("triggerSortOpen"))}),$(document).on("click",".triggerSort",function(e){e.preventDefault(),$(".sortSection").slideToggle(),$(this).toggleClass("triggerSortOpen"),$(".filterSection").is(":visible")&&($(".filterSection").slideToggle(),$(this).toggleClass("triggerFilterOpen"))}),$(document).on("click",".toggleAbbrevations",function(e){e.preventDefault(),$(".abbrlist").slideToggle()}),$(document).on("change","#sortingType",function(e){L=$(this).find("option:selected").prop("value"),$(".triggerSort").trigger("click"),o()}),$.ajax({url:"/api/citytown.php",dataType:"json",success:function(e){var t=e[0].city;$("span.selectedCity").text(t),d=t;var o=$("#optionCity").html();Mustache.parse(o);var i=Mustache.render(o,{data:e});$(".selectCity").html(i).material_select(),$.ajax({url:"/api/citytown.php?city="+d,dataType:"json",success:function(e){selectTown=e[0].town,$("span.selectedTown").text(selectTown),h=selectTown;var t=$("#optionTown").html();Mustache.parse(t);var o=Mustache.render(t,{data:e});$(".selectTown").html(o).material_select()}})}}),$.ajax({url:"/api/filter.php",dataType:"json",success:function(e){y=+e.maxcost,T=e.residentialtypes,v=e.commercialtypes}}),$(document).on("change","select.selectTown",function(e){f=0,u="",$(".filterArea").slideToggle(),$(".changeFilter").toggleClass("filterOpen"),$("span.selectedTown").text($(this).find("option:selected").attr("value")),h=$(this).find("option:selected").attr("value"),u="",i(),$(".button-collapse").sideNav("hide")}),$(document).on("change","select.selectCity",function(e){f=0,u="",$("span.selectedCity").text($(this).find("option:selected").attr("value")),d=$(this).find("option:selected").attr("value"),u="",$(".button-collapse").sideNav("hide"),$.ajax({url:"/api/citytown.php?city="+d,dataType:"json",success:function(e){selectTown=e[0].town,$("span.selectedTown").text(selectTown),h=selectTown;var t=$("#optionTown").html();Mustache.parse(t);var o=Mustache.render(t,{data:e});$("select.selectTown").empty().html(o).material_select()},complete:function(){i()}})}),$(document).on("click",".showAgentList",function(e){e.preventDefault(),window.location.hash="agentlist"}),$(document).on("click",".showPropertyList",function(e){e.preventDefault(),window.location.hash="propertylist"}),$(document).on("click",".triggerSell",function(e){e.preventDefault(),f=0,$(window).scrollTop(0),$(".triggerRent").removeClass("active"),$(this).addClass("active"),o()}),$(document).on("click",".triggerAgentSell",function(e){e.preventDefault(),f=0,$(window).scrollTop(0);var t=$(this).attr("email");$.ajax({url:"/api/agentinfo.php",method:"get",data:{email:t,sellrent:"sell"},success:function(e){r(e),$(".triggerAgentSell").addClass("active")}})}),$(document).on("change","#propertyCat",function(e){$(".resproptypedd,.commprotypedd").hide();var t=$(this).find("option:selected").prop("value");"residential"===t?$(".resproptypedd").fadeIn("fast"):"commercial"===t?$(".commprotypedd").fadeIn("fast"):$(".resproptypedd").fadeIn("fast"),C=t,""===C&&(S=""),o()}),$(document).on("change","#residentialPropertyType,#commercialPropertyType",function(e){S=$(this).find("option:selected").prop("value"),o()}),$(document).on("click",".triggerRent",function(e){e.preventDefault(),f=0,$(window).scrollTop(0),o("rent"),$(".triggerSell").removeClass("active"),$(this).addClass("active")}),$(document).on("click",".triggerAgentRent",function(e){e.preventDefault(),f=0,$(window).scrollTop(0);var t=$(this).attr("email");$.ajax({url:"/api/agentinfo.php",method:"get",data:{email:t,sellrent:"rent"},success:function(e){r(e,"rent"),$(".triggerAgentRent").addClass("active")}})}),$(document).on("click",".propertySearchResult .collection-item",function(e){var t=$(this).next(".tabBody");t.slideToggle()}),$(document).on("click",".agentSearchResult .collection-item",function(e){var t=$(this).attr("agentEmail");$.ajax({url:"/api/agentinfo.php",method:"get",data:{email:t,sellrent:g},success:function(e){r(e),$(".triggerAgentSell").addClass("active")}})}),n("uid")){var R=$.trim(n("uid"));$.ajax({url:"/api/agentinfo.php",method:"get",data:{uid:R,sellrent:g},success:function(e){$(".listView").show(),r(e)}})}$(document).on("click",function(e){return e.target.classList.contains("filterSection")||e.target.classList.contains("sortSection")||e.target.classList.contains("filterArea")?!1:e.target.classList.contains("material-icons")&&(e.target.parentNode.classList.contains("triggerFilter")||e.target.parentNode.classList.contains("triggerSort")||e.target.parentNode.classList.contains("changeFilter"))?!1:e.target.classList.contains("triggerFilter")||e.target.classList.contains("triggerSort")||e.target.classList.contains("changeFilter")?!1:$(".filterSection").find(e.target).length>0||$(".sortSection").find(e.target).length>0||$(".filterArea").find(e.target).length>0?!1:($(".filterSection").slideUp("fast"),$(".triggerFilter").removeClass("triggerFilterOpen"),$(".sortSection").slideUp("fast"),$(".triggerSort").removeClass("triggerSortOpen"),$(".filterArea").slideUp("fast"),void $(".changeFilter").removeClass("filterOpen"))}),$(document).on("click",".resetAppliedFilter",function(t){t.preventDefault(),e(),o()}),$(document).on("click",".closePopUp",function(e){e.preventDefault(),$("#addPropertyModal").closeModal()}),window.onhashchange=function(){var t=window.location.hash;return e(),$(".modal-trigger").off().leanModal(),"#agentlist"===t?(f=0,u="",$(window).scrollTop(0),$(".module:not(.agentListView)").hide(),$(".listView").show(),$(".agentListView").fadeIn("fast"),m?$("#slide-out").show():($(".button-collapse").sideNav({menuWidth:300,edge:"left",closeOnClick:!0}),$("#slide-out").show(),m=!0),i(),$(".button-collapse").sideNav("hide"),a(),void $("a.button-collapse.hide-on-large-only").show()):"#propertylist"===t?(f=0,u="",$(window).scrollTop(0),$(".module:not(.propertyListView)").hide(),$(".listView").show(),$(".propertyListView").fadeIn("fast"),m?$("#slide-out").show():($(".button-collapse").sideNav({menuWidth:300,edge:"left",closeOnClick:!0}),$("#slide-out").show(),m=!0),i(),$(".button-collapse").sideNav("hide"),s(),l(),c(),$(".triggerSell").addClass("active"),void $("a.button-collapse.hide-on-large-only").show()):"#agentinfo"===t?($("#slide-out").show(),$(".showAgentList").show(),$(window).scrollTop(0),void $("a.button-collapse.hide-on-large-only").show()):(f=0,u="",$(window).scrollTop(0),$(".module:not(.landingPage)").hide(),$(".landingPage").show(),$(".showAgentList,.showPropertyList").show(),$("#slide-out").hide(),$("a.button-collapse.hide-on-large-only").hide(),void 0)},window.location=window.location+"#",window.location.hash="",$(".modal-trigger").off().leanModal()}();